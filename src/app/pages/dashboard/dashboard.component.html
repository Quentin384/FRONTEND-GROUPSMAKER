<div class="dashboard">
  <!-- Bouton admin -->
  <button *ngIf="isAdmin()" (click)="redirigerVersAdmin()" class="btn-admin">
    🎛 Accéder à l’administration
  </button>

  <h1>Vos listes</h1>

  <!-- Création de nouvelle liste (avec ajout de personnes à la volée avant envoi) -->
  <app-form-liste (nouvelleListe)="ajouterListe($event)"></app-form-liste>

  <!-- Affichage de toutes les listes existantes -->
  <div *ngFor="let liste of listes" class="liste">
    <h2>
      {{ liste.nom }}
      <span class="badge">{{ (liste.personnes || []).length }} personnes</span>
      <span class="badge tirages">{{ liste.tirages }} tirages</span>
    </h2>

    <!-- Liste des personnes associées à cette liste -->
    <ul>
      <li *ngFor="let p of liste.personnes">
        👤 <strong>{{ p.nom }}</strong>
        | Genre : {{ p.genre }}
        | 🇫🇷 Français : {{ p.aisanceFrancais }}/4
        | 👵 Ancien DWWM : {{ p.ancienDWWM ? 'Oui' : 'Non' }}
        | 🔧 Tech : {{ p.niveauTechnique }}/4
        | Profil : {{ p.profil }}
        | Âge : {{ p.age }}
      </li>
    </ul>

    <!-- Ajout d'une personne dans cette liste -->
    <form (ngSubmit)="ajouterPersonneDansListe(liste.id)" class="form form-inline">
      <input type="text" placeholder="Nom" [(ngModel)]="personneForm[liste.id].nom" name="nom-{{liste.id}}" required minlength="4" maxlength="49" />
      <select [(ngModel)]="personneForm[liste.id].genre" name="genre-{{liste.id}}" required>
        <option value="MASCULIN">Masculin</option>
        <option value="FEMININ">Féminin</option>
        <option value="NE_SE_PRONONCE_PAS">Ne se prononce pas</option>
      </select>
      <select [(ngModel)]="personneForm[liste.id].aisanceFrancais" name="aisanceFrancais-{{liste.id}}" required>
        <option *ngFor="let n of [1,2,3,4]" [value]="n">{{ n }}</option>
      </select>
      <label>
        <input type="checkbox" [(ngModel)]="personneForm[liste.id].ancienDWWM" name="ancienDWWM-{{liste.id}}" />
        Ancien DWWM
      </label>
      <select [(ngModel)]="personneForm[liste.id].niveauTechnique" name="niveauTechnique-{{liste.id}}" required>
        <option *ngFor="let n of [1,2,3,4]" [value]="n">{{ n }}</option>
      </select>
      <select [(ngModel)]="personneForm[liste.id].profil" name="profil-{{liste.id}}" required>
        <option value="TIMIDE">Timide</option>
        <option value="RESERVE">Réservé</option>
        <option value="A_L_AISE">À l’aise</option>
      </select>
      <input type="number" placeholder="Âge" [(ngModel)]="personneForm[liste.id].age" name="age-{{liste.id}}" min="1" max="99" required />
      <button type="submit">Ajouter à cette liste</button>
    </form>
    <!-- ... Ici tu peux rajouter la partie groupes/tirages/historique comme avant ... -->
  </div>
</div>
